<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport"="width=device-width, initial-scale=1.0">
    <title>NGƯỜI LÙN SINH NHẬT?!?</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Dancing+Script:wght@400;600&display=swap">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <!-- <link rel="stylesheet" href="style.css"> -->
    <!-- Thêm jQuery từ CDN -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <style>
        :root {
            --color-env: #ecd3ff;
            --color-env2: #cf9cff;
            --color-flap: #cf9cff;
            --color-bg: #efe6fa;
            --color-heart: #c79bff;
            --env-width: min(280px, 80vw);
            --env-height: min(180px, 50vw);
            --heart-width: min(50px, 14vw);
            --env-border-radius: min(6px, 2vw);
        }

        body {
            background-color: var(--color-bg);
            font-family: 'Roboto', sans-serif; /* Use a clean and simple font */
            margin: 0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .envlope-wrapper {
            height: calc(var(--env-height) + 200px); /* Giữ nguyên */
            height: 100vh;
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        #envelope {
            position: relative;
            width: var(--env-width);
            height: var(--env-height);
            border-bottom-left-radius: var(--env-border-radius);
            border-bottom-right-radius: var(--env-border-radius);
            margin-left: auto;
            margin-right: auto;
            top: 250px;
            background-color: var(--color-flap);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            animation: tran 3s infinite;
            position: relative;
            top: 0;
            transform: translateY(0);
        }

        /* Update zoom scale for different screen sizes */
        @media screen and (orientation: landscape) {
            .zoom .letter {
                /* Calculate scale based on viewport height */
                transform: scale(calc(90vh / var(--env-height))) 
                        translateY(calc(-1 * (var(--env-height) / 30))) 
                        rotate(-5deg);
            }

            /* Adjust arrow position */
            .spiral-arrow {
                top: 50%;
                transform: translateY(-50%) rotate(-20deg);
                left: calc(50% + var(--env-width) / 2 + 20px);
            }

            .arrow-text {
                top: 50%;
                transform: translateY(-50%);
                left: calc(50% + var(--env-width) / 2 + 90px);
            }
        }

        /* Smaller screens */
        @media screen and (max-width: 480px) and (orientation: landscape) {
            :root {
                --env-width: min(240px, 70vw);
                --env-height: min(150px, 40vw);
            }

            .zoom .letter {
                /* Slightly smaller scale for very small screens */
                transform: scale(calc(80vh / var(--env-height))) 
                        translateY(calc(-1 * (var(--env-height) / 30))) 
                        rotate(-5deg);
            }
        }

        @keyframes tran {
            0% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(20px);

            }

            100% {
                transform: translateY(0px);
            }
        }

        .front {
            position: absolute;
            width: 0;
            height: 0;
            z-index: 3;
        }

        .flap {
            border-left: calc(var(--env-width) / 2) solid transparent;
            border-right: calc(var(--env-width) / 2) solid transparent;
            border-bottom: calc((var(--env-height) / 2) - 8) solid transparent;
            border-top: calc((var(--env-height) / 2) + 8) solid var(--color-flap);
            transform-origin: top;
            pointer-events: none;
        }

        .pocket {
            border-left: calc(var(--env-width) / 2) solid var(--color-env);
            border-right: calc(var(--env-width) / 2) solid var(--color-env);
            border-bottom: calc(var(--env-height) / 2) solid var(--color-env2);
            border-top: calc(var(--env-height) / 2) solid transparent;
            border-bottom-left-radius: var(--env-border-radius);
            border-bottom-right-radius: var(--env-border-radius);
            z-index: 40;
        }

        .pocket2 {
            position: absolute;
            border-left: calc(var(--env-width) / 2) solid transparent;
            border-right: calc(var(--env-width) / 2) solid transparent;
            border-bottom: calc(var(--env-height) / 2) solid transparent;
            border-top: calc(var(--env-height) / 2) solid var(--color-env2);
            border-bottom-left-radius: var(--env-border-radius);
            border-bottom-right-radius: var(--env-border-radius);
            transform-origin: top;
            transform: translateY(0%) rotateX(0deg);
            transition: transform 0.8s ease, z-index 0.6s;
            z-index: 2;
        }


        .letter {
        position: relative;
        background-color: #fff;
        width: 90%;
        margin-left: auto;
        margin-right: auto;
        height: 90%;
        top: 5%;
        border-radius: 10px;
        box-shadow: 0 2px 26px rgba(0, 0, 0, 0.12);
        transition: transform 0.4s ease;
        overflow-y: auto;
        overflow-x: hidden;
        max-height: 80%;
        padding: 10px;

        /* GPU acceleration for better rendering */
        backface-visibility: hidden;
        perspective: 1000px;
        image-rendering: crisp-edges;
    }

    /* Tùy chỉnh thanh cuộn */
    .letter::-webkit-scrollbar {
        width: 3px; /* Độ rộng của thanh cuộn */
    }

    .letter::-webkit-scrollbar-track {
        background: #f0f0f0; /* Màu nền của track */
        border-radius: 10px; /* Bo góc track */
    }

    .letter::-webkit-scrollbar-thumb {
        background: #e0c0ff; /* Màu của thanh cuộn */
        border-radius: 10px; /* Bo góc thanh cuộn */
    }

    .letter::-webkit-scrollbar-thumb:hover {
        background: #d191ff; /* Màu khi hover */
    }

    .letter:after {
        content: none;
    }

    .words {
        font-family: 'Roboto', sans-serif;
        font-size: 1.2em; /* Điều chỉnh kích thước chữ */
        line-height: 1.6; /* Tăng khoảng cách dòng */
        margin: 0 auto 10px auto; /* Căn giữa nội dung và thêm khoảng cách dưới */
        text-align: justify; /* Căn đều nội dung */
        width: 90%; /* Giới hạn chiều rộng nội dung */
    }

    .words.line2 {
        position: relative; /* Đảm bảo vị trí tương đối */
        left: 0; /* Đặt lại căn lề trái */
        width: 100%; /* Đảm bảo nội dung chiếm toàn bộ chiều rộng */
        color: #333;
        font-size: 0.3em; /* Điều chỉnh kích thước chữ */
        font-weight: 400;
        line-height: 1.6; /* Tăng khoảng cách dòng */
        letter-spacing: 0.02em; /* Thêm khoảng cách giữa các chữ */
        text-align: justify; /* Căn đều nội dung */
    }

    .words.line1 {
        text-align: center; /* Căn giữa nội dung tiêu đề */
        font-size: 0.5em; /* Tăng kích thước chữ tiêu đề */
        font-weight: bold;
        color: #ff1493;
    }

    .words.line3 {
        text-align: right; /* Căn chữ sang phải */
        font-size: 0.2em; /* Điều chỉnh kích thước chữ */
        color: #6a5acd !important;
        margin-top: 20px; /* Thêm khoảng cách trên */
    }

        .open .flap {
            transform: rotateX(180deg);
            transition: transform 0.4s ease, z-index 0.6s;
            z-index: 1;
        }

        .close .flap {
            transform: rotateX(0deg);
            transition: transform 0.4s 0.6s ease, z-index 1s;
            z-index: 5;
        }

        .close .letter {
            transform: translateY(0px);
            transition: transform 0.4s ease, z-index 1s;
            z-index: 1;
        }

        .open .letter {
            transform: translateY(calc(-1 * (var(--env-height) / 3))) rotate(-5deg);
            transition: transform 0.4s 0.6s ease, z-index 0.6s;
            z-index: 2;
        }

        .open .pocket2 {
            transform: translateY(0%) rotateX(180deg);
        }

        .zoom .letter {
        transform: scale(4) translateY(calc(-1 * (var(--env-height) / 30))) rotate(-5deg);
        transition: transform 1s ease;
        z-index: 22222;
    }

        .hearts {
            position: absolute;
            top: calc(var(--env-height) / 2);
            left: 0;
            right: 0;
            z-index: 2;
        }

        .heart {
            position: absolute;
            bottom: 0;
            right: 10%;
            pointer-events: none;
        }

        .heart:before,
        .heart:after {
            position: absolute;
            content: "";
            left: var(--heart-width);
            top: 0;
            width: var(--heart-width);
            height: calc(var(--heart-width) * 1.6);
            background: var(--color-heart);
            border-radius: var(--heart-width) var(--heart-width) 0 0;
            transform: rotate(-45deg);
            transform-origin: 0 100%;
            pointer-events: none;
        }

        .heart:after {
            left: 0;
            transform: rotate(45deg);
            transform-origin: 100% 100%;
        }

        .close .heart {
            opacity: 0;
            animation: none;
        }

        .a1 {
            left: 20%;
            transform: scale(0.6);
            opacity: 1;
            animation: slideUp 4s linear 1, sideSway 2s ease-in-out 4 alternate;
            animation-fill-mode: forwards;
            animation-delay: 0.7s;
        }

        .a2 {
            left: 55%;
            transform: scale(1);
            opacity: 1;
            animation: slideUp 5s linear 1, sideSway 4s ease-in-out 2 alternate;
            animation-fill-mode: forwards;
            animation-delay: 0.7s;
        }

        .a3 {
            left: 10%;
            transform: scale(0.8);
            opacity: 1;
            animation: slideUp 7s linear 1, sideSway 2s ease-in-out 6 alternate;
            animation-fill-mode: forwards;
            animation-delay: 0.7s;
        }

        /* Update the spiral-arrow and arrow-text styles */
        .spiral-arrow {
            position: absolute;
            width: min(100px, 15vw);
            height: min(86px, 13vw);
            top: 50%;
            left: calc(50% + var(--env-width)/2 + min(50px, 8vw));
            transform: translateY(-50%) rotate(-20deg);
            fill: #ff6b81;
            z-index: 10;
            opacity: 1;
            transition: all 0.5s ease;
            pointer-events: none;
        }

        .arrow-text {
            position: absolute;
            font-family: 'Dancing Script', cursive; /* Giữ font chữ viết tay */
            top: 50%;
            left: calc(50% + var(--env-width)/2 + min(150px, 25vw));
            transform: translateY(-50%);
            font-size: min(30px, 8vw); /* Further increase font size */
            font-weight: bold; /* Make the text bold for better readability */
            letter-spacing: 0.05em; /* Add slight spacing for clarity */
            color: #ff6b81;
            white-space: nowrap;
            z-index: 10;
            opacity: 1;
            transition: all 0.5s ease;
            pointer-events: none;
        }

        /* Add these new styles for open state */
        .open .spiral-arrow {
            transform: translateY(calc(-50% - var(--env-height)/3)) rotate(-20deg);
        }

        .open .arrow-text {
            transform: translateY(calc(-50% - var(--env-height)/3));
        }

        /* Update zoom state */
        .zoom .spiral-arrow,
        .zoom .arrow-text {
            opacity: 0;
            transition: opacity 0.2s ease, transform 0.4s ease;
        }

        /* Update media query for landscape orientation */
        @media screen and (orientation: landscape) {
            .spiral-arrow, .arrow-text {
                transition: transform 0.4s ease, opacity 0.5s ease;
            }
            
            .open .spiral-arrow {
                transform: translateY(calc(-50% - var(--env-height)/3)) rotate(-20deg);
            }
            
            .open .arrow-text {
                transform: translateY(calc(-50% - var(--env-height)/3));
            }
        }

        /* Khi zoom: ẩn cả mũi tên và chữ */
        .envlope-wrapper.zoom .spiral-arrow,
        .envlope-wrapper.zoom .arrow-text {
            opacity: 0;
            transition: opacity 0.2s ease; /* Mờ dần trong 0.5s */
        }

        /* Khi không zoom: hiện lại với trì hoãn 1s */
        .envlope-wrapper:not(.zoom) .spiral-arrow,
        .envlope-wrapper:not(.zoom) .arrow-text {
            opacity: 1;
            transition: opacity 0.5s ease 1s; /* Fade in sau 1s */
        }

        @keyframes slideUp {
            0% {
                top: 0;
            }

            100% {
                top: -600px;
            }
        }

        @keyframes sideSway {
            0% {
                margin-left: 0px;
            }

            100% {
                margin-left: 50px;
            }
        }

        /* Add styles for the split text */
        .orientation-message {
            display: flex;
            flex-direction: column;
            align-items: center; /* Ensure content is centered horizontally */
            text-align: center; /* Center text alignment */
            gap: 8px;
        }
        
        .orientation-message h2 {
            color: #ff6b81;
            font-family: 'Dancing Script', cursive;
            margin: 0;
            text-align: center;
            font-size: min(50px, 8vw); /* Further increase font size for better readability */
            line-height: 1.8; /* Add more line height for better spacing */
        }

        /* Mobile portrait orientation warning */
        .orientation-warning {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 50px;
            font-size: 1.8em;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--color-bg);
            z-index: 9999;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 50px; /* Add even more padding for better spacing */
            font-size: 1.8em; /* Further increase font size */
        }

        .orientation-warning img {
            width: 100px; /* Increase size from 64px to 128px */
            height: 100px; /* Ensure proportional height */
            margin-bottom: 30px; /* Add more spacing below the icon */
            animation: rotate 2s infinite;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(90deg); }
        }

        /* Update media queries for better mobile zoom scaling */
        @media screen and (max-width: 768px) {
            .zoom .letter {
                transform: scale(1.5) translateY(calc(-1 * (var(--env-height) / 30))) rotate(-5deg) translateZ(0);
                -webkit-transform: scale(1.5) translateY(calc(-1 * (var(--env-height) / 30))) rotate(-5deg) translateZ(0);
                backface-visibility: hidden;
                -webkit-backface-visibility: hidden;
                -webkit-perspective: 1000;
            }
            
            .words {
                /* Tăng độ sắc nét cho text trên mobile */
                font-size: 0.7em; /* Tăng font size một chút */
                letter-spacing: 0.02em; /* Thêm khoảng cách giữa các chữ */
            }
        }

        @media screen and (max-width: 480px) and (orientation: landscape) {
            :root {
                --env-width: min(240px, 70vw);
                --env-height: min(150px, 40vw);
            }

            .zoom .letter {
                /* Smaller scale for mobile devices */
                transform: scale(1.2) translateY(calc(-1 * (var(--env-height) / 30))) rotate(-5deg);
            }
        }

        /* Add new media query for very small devices */
        @media screen and (max-width: 360px) and (orientation: landscape) {
            .zoom .letter {
                /* Even smaller scale for very small devices */
                transform: scale(1) translateY(calc(-1 * (var(--env-height) / 30))) rotate(-5deg);
            }
        }

        /* Portrait orientation check */
        @media screen and (orientation: portrait) and (max-width: 768px) {
            .orientation-warning {
                display: flex;
            }
            .envlope-wrapper {
                display: none;
            }
        }

        .scroll-indicator {
        position: absolute; /* Đặt vị trí tương đối với .envlope-wrapper */
        bottom: 23%; /* Cách đáy lá thư 10% */
        left: 30%; /* Cách trái lá thư 5% */
        background-color: #b572f4; /* Màu nền */
        color: #fff; /* Màu chữ */
        font-size: 0.8em; /* Kích thước chữ */
        padding: 6px 12px; /* Khoảng cách bên trong */
        border-radius: 15px; /* Bo góc dạng viên nang */
        box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1); /* Đổ bóng */
        z-index: 1000; /* Đảm bảo nằm trên các phần tử khác */
        display: none; /* Ẩn mặc định */
        transform: rotate(-5deg); /* Góc nghiêng cùng lá thư */
        animation: fadeInOut 2s infinite; /* Hiệu ứng nhấp nháy */
    }

    .scroll-indicator p {
        margin: 0; /* Loại bỏ khoảng cách mặc định */
        margin-left: 5px;
    }

    .envlope-wrapper.zoom .scroll-indicator {
        display: flex; /* Hiển thị khi lá thư được zoom */
    }

    @keyframes fadeInOut {
        0%, 100% {
            opacity: 1;
        }
        50% {
            opacity: 0.5;
        }
    }

    /* Add floating background animation styles */
    .floating-images {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1; /* Ensure it stays behind other content */
    }

    .float {
        position: absolute;
        width: 100px;
        height: 100px;
        object-fit: cover;
        border: 3px solid white;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        animation: gentleFloat 8s ease-in-out infinite;
        will-change: transform, left, top;
        backface-visibility: hidden;
        perspective: 1000px;
    }

    @keyframes gentleFloat {
        0% { transform: translate(var(--tx-0), var(--ty-0)) rotate(var(--rot-0)); }
        25% { transform: translate(var(--tx-25), var(--ty-25)) rotate(var(--rot-25)); }
        50% { transform: translate(var(--tx-50), var(--ty-50)) rotate(var(--rot-50)); }
        75% { transform: translate(var(--tx-75), var(--ty-75)) rotate(var(--rot-75)); }
        100% { transform: translate(var(--tx-0), var(--ty-0)) rotate(var(--rot-0)); }
    }
    </style>
</head>

<body>
    <!-- Add floating images container -->
    <div class="floating-images">
        <img src="img/1.png" class="float" alt="floating image 1">
        <img src="img/2.png" class="float" alt="floating image 2">
        <img src="img/3.png" class="float" alt="floating image 3">
        <img src="img/4.png" class="float" alt="floating image 4">
        <img src="img/5.png" class="float" alt="floating image 5">
        <img src="img/6.png" class="float" alt="floating image 6">
        <img src="img/7.png" class="float" alt="floating image 7">
        <img src="img/8.png" class="float" alt="floating image 8">
        <img src="img/9.png" class="float" alt="floating image 9">
        <img src="img/10.png" class="float" alt="floating image 10">
    </div>

    <div class="orientation-warning">
        <div class="orientation-message">
            <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23ff6b81' d='M16 2H8C6.3 2 5 3.3 5 5v14c0 1.7 1.3 3 3 3h8c1.7 0 3-1.3 3-3V5c0-1.7-1.3-3-3-3zm1 17c0 .6-.4 1-1 1H8c-.6 0-1-.4-1-1V5c0-.6.4-1 1-1h8c.6 0 1 .4 1 1v14z'/%3E%3C/svg%3E" alt="Rotate device">
            <h2>Xoay ngang điện thoại</h2>
            <h2>để xem nha người đẹp! 💌</h2>
        </div>
    </div>

    <div class="envlope-wrapper">
        <div id="envelope" class="close">
            <div class="front">
                <div class="flap"></div>
                <div class="pocket"></div>
            </div>
            <div class="pocket2"></div>
           
            <div class="letter">
                
                <div class="words line1">Happy Birthday Người Đẹp!</div>
                <div class="words line2">Yé, vậy là lại một năm nữa đã trôi qua, m lại lớn thêm một tuổi. Đến gần hơn với hố—à không, đến gần hơn với cái tuổi trưởng thành, phải gánh vác nhiều trách nhiệm lớn lao (chắc thế :D). Nhưng mà yên tâm đi, dù m có ăn hại bao nhiêu đi nữa, dù cuộc đời có quăng cho mấy cái đập vào mồm thì m vẫn sẽ luôn là mặt trăng dịu dàng giữa bầu trời tối đen thui, vừa đủ sáng để dẫn lối, vừa đủ xinh đẹp để người ta ngước nhìn (để ngước nhìn ngta chứ?!?)</div>
                <div class="words line2">Chúc m năm nay học hành tấn tới, ăn gì cũng không béo (mơ tí thôi), tiền vô như nước sông Đà, mà tiền ra thì như nhỏ giọt cà phê phin nhé =)) (éo phải là bảo m ki bo đâu nên là cho t tiền đi 🫠)</div>
                <div class="words line2">Và.. đừng quên t còn ở đây, luôn sẵn sàng nghe m xà lơ, than khổ (?!?), hay là chỉ để nuôi cái chuỗi toptop gần 300 ngày :></div>
                <div class="words line2">Lời cuối cùng, Tiểu Vụ tại hạ xin chúc Nguyệt Nguyệt Tiểu Thư có một ngày sinh nhật vui vẻ và ngập tràn điều may mắn ạ! =)))))</div>
                <div class="words line3" style="color: #6a5acd;">~ thằng cốt đơ dốt toán lý anh :)) ~</div>
            </div>
            <div class="hearts">
                <div class="heart a1"></div>
                <div class="heart a2"></div>
                <div class="heart a3"></div>
            </div>
        </div>
        <div class="scroll-indicator">
            <i class="fa-solid fa-angle-down"></i>
            <p> Vuốt xuống</p>
        </div>
        <svg class="spiral-arrow" xmlns="http://www.w3.org/2000/svg" shape-rendering="geometricPrecision" text-rendering="geometricPrecision" image-rendering="optimizeQuality" fill-rule="evenodd" clip-rule="evenodd" viewBox="0 0 512 442.136">
            <path d="M13.465 0c31.386 25.229 67.041 47.435 83.064 62.714 5.281 5.036 11.006 12.153 1.663 8.574-25.872-9.91-54.003-27.667-75.003-49.744 2.547 18.498-2.366 41.616-9.997 60.504-.938 2.328-3.886 11.918-7.546 15.088-1.359 1.178-2.82 1.473-4.308.18C.489 96.578.059 95.321.005 93.61c-.152-4.983 3.388-19.558 6.693-33.835C11.603 38.592 14.12 21.992 13.465 0z"/>
            <path d="M268.172 205.788c-4.322 22.157-5.797 44.279-4.95 66.743-45.792-16.983-86.744-47.759-120.988-82.095-41.377-41.486-75.893-91.78-100.677-142.433-7.709-15.756-12.142-22.106-22.78-36.215 19.82 95.783 137.212 251.196 246.697 274.193C279.782 412.974 408.945 495.853 512 401.432c-95.354 64.986-210.522 25.748-234.658-113.479 11.685 1.413 23.233 1.218 34.515-.824 26.693-4.83 52.462-12.783 72.736-38.719 28.125-35.979 26.324-94.975-19.286-115.588-54.862-24.791-87.927 25.74-97.135 72.966zm7.016 67.488c-.889-23.576 1.128-48.171 6.111-71.196 8.03-37.107 29.726-69.192 65.407-62.82 22.084 3.943 35.695 18.675 40.56 38.116 17.522 70.029-62.617 107.875-112.078 95.9z"/>
        </svg>
        <div class="arrow-text">Ấn vô đây điii :)</div> <!-- Thêm chữ -->
    </div>
    <script>
        $(document).ready(function () {
            var envelope = $('#envelope');
            var wrapper = $('.envlope-wrapper');
            var clickCount = 0;
            var scrollIndicator = $('.scroll-indicator');
            var letter = $('.letter');

            // Hiển thị nút viên nang khi zoom
            function zoomLetter() {
                envelope.addClass("zoom");
                wrapper.addClass("zoom");
                scrollIndicator.fadeIn(); // Hiển thị nút viên nang
            }

            // Ẩn nút viên nang khi thu nhỏ
            function normalizeLetter() {
                scrollIndicator.fadeOut(); // Ẩn nút viên nang
                setTimeout(() => {
                    envelope.removeClass("zoom");
                    wrapper.removeClass("zoom");
                }, 500);
            }

            // Lắng nghe sự kiện cuộn trên .letter
            letter.on('scroll', function () {
                var scrollTop = letter.scrollTop(); // Vị trí cuộn hiện tại
                var scrollHeight = letter[0].scrollHeight; // Chiều cao nội dung
                var clientHeight = letter[0].clientHeight; // Chiều cao hiển thị

                // Kiểm tra nếu người dùng đã cuộn hết
                if (scrollTop + clientHeight >= scrollHeight - 10) {
                    scrollIndicator.find('p').text('Hết rùi'); // Thay đổi nội dung
                } else {
                    scrollIndicator.find('p').text('Vuốt xuống'); // Khôi phục nội dung
                }
            });
            
            // Check orientation on page load
            checkOrientation();

            envelope.on('click', function () {
                clickCount++;
                if (clickCount === 1) {
                    openEnvelope();
                } else if (clickCount === 2) {
                    zoomLetter();
                } else if (clickCount === 3) {
                    normalizeLetter();
                } else if (clickCount === 4) {
                    closeEnvelope();
                    clickCount = 0;
                }
            });
    
            function openEnvelope() {
                envelope.addClass("open").removeClass("close");
            }
    
        // Hiển thị nút viên nang khi zoom
        function zoomLetter() {
            envelope.addClass("zoom");
            wrapper.addClass("zoom");
            scrollIndicator.fadeIn(); // Hiển thị nút viên nang

            const viewportHeight = window.innerHeight;
            const viewportWidth = window.innerWidth;
            const letterHeight = letter.height();
            const letterWidth = letter.width();

            // Tính toán tỷ lệ zoom
            let baseScale = Math.min(
                (viewportHeight * 0.8) / letterHeight,
                (viewportWidth * 0.8) / letterWidth
            );

            // Giới hạn tỷ lệ zoom cho các thiết bị nhỏ
            let finalScale = baseScale;
            if (viewportWidth <= 360) {
                finalScale = Math.min(baseScale, 1.2);
            } else if (viewportWidth <= 480) {
                finalScale = Math.min(baseScale, 1.5);
            } else if (viewportWidth <= 768) {
                finalScale = Math.min(baseScale, 2.0);
            } else {
                finalScale = Math.min(baseScale, 3.0);
            }

            // Áp dụng zoom với GPU acceleration
            letter.css({
                'transform': `scale(${finalScale}) translateY(calc(-1 * (var(--env-height) / 30))) rotate(-5deg)`,
                'transition': 'transform 0.5s ease-in-out',
                'backface-visibility': 'hidden',
                'perspective': '1000px',
                'image-rendering': 'crisp-edges'
            });
        }
    
            function normalizeLetter() {
                // First update CSS for smooth transition back
                $('.letter').css({
                    'transform': 'scale(1) translateY(0) rotate(0)',
                    'transition': 'transform 0.5s ease-in-out'
                });
                
                // Remove zoom classes after transition
                setTimeout(() => {
                    envelope.removeClass("zoom");
                    wrapper.removeClass("zoom");
                }, 500);
            }
    
            function closeEnvelope() {
                envelope.addClass("close").removeClass("open zoom");
                wrapper.removeClass("zoom");
                $('.letter').css({
                    'transform': '',
                    'transition': ''
                });
            }

            function checkOrientation() {
                if (window.innerHeight > window.innerWidth) {
                    $('.orientation-warning').css('display', 'flex');
                    $('.envlope-wrapper').hide();
                } else {
                    $('.orientation-warning').css('display', 'none');
                    $('.envlope-wrapper').show();
                }
            }

            window.addEventListener('orientationchange', function() {
                setTimeout(checkOrientation, 100);
            });

            // Initialize floating images animation
            document.addEventListener('DOMContentLoaded', function () {
                const floatImages = document.querySelectorAll('.float');

                function positionImages() {
                    const padding = 60; // Safe padding from edges
                    const safeWidth = window.innerWidth - (2 * padding) - 100;
                    const safeHeight = window.innerHeight - (2 * padding) - 100;

                    floatImages.forEach(img => {
                        const x = padding + Math.random() * safeWidth;
                        const y = padding + Math.random() * safeHeight;

                        img.style.left = `${x}px`;
                        img.style.top = `${y}px`;

                        // Generate random offsets for animation
                        img.style.setProperty('--tx-0', '0px');
                        img.style.setProperty('--ty-0', '0px');
                        img.style.setProperty('--tx-25', `${(Math.random() - 0.5) * 15}px`);
                        img.style.setProperty('--ty-25', `${(Math.random() - 0.5) * 20}px`);
                        img.style.setProperty('--tx-50', `${(Math.random() - 0.5) * 10}px`);
                        img.style.setProperty('--ty-50', `${(Math.random() - 0.5) * 15}px`);
                        img.style.setProperty('--tx-75', `${(Math.random() - 0.5) * 12}px`);
                        img.style.setProperty('--ty-75', `${(Math.random() - 0.5) * 18}px`);
                        img.style.setProperty('--rot-0', '0deg');
                        img.style.setProperty('--rot-25', `${(Math.random() - 0.5) * 4}deg`);
                        img.style.setProperty('--rot-50', `${(Math.random() - 0.5) * 3}deg`);
                        img.style.setProperty('--rot-75', `${(Math.random() - 0.5) * 3.5}deg`);
                    });
                }

                positionImages();
                window.addEventListener('resize', positionImages);
            });
        });
    </script>
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const floatImages = document.querySelectorAll('.float');
        const sections = { desktop: { padding: 60 }, mobile: { padding: 30 } };
        let draggedItem = null, isDragging = false, initialX, initialY, maxZIndex = 2;

        function positionImages() {
            const isMobile = window.innerWidth <= 600;
            const padding = isMobile ? sections.mobile.padding : sections.desktop.padding;
            const safeWidth = window.innerWidth - (2 * padding) - 100;
            const safeHeight = window.innerHeight - (2 * padding) - 100;

            floatImages.forEach(img => {
                const x = padding + Math.random() * safeWidth;
                const y = padding + Math.random() * safeHeight;
                img.style.left = `${x}px`;
                img.style.top = `${y}px`;
                img.style.setProperty('--tx-0', '0px');
                img.style.setProperty('--ty-0', '0px');
                img.style.setProperty('--tx-25', `${(Math.random() - 0.5) * 15}px`);
                img.style.setProperty('--ty-25', `${(Math.random() - 0.5) * 20}px`);
                img.style.setProperty('--tx-50', `${(Math.random() - 0.5) * 10}px`);
                img.style.setProperty('--ty-50', `${(Math.random() - 0.5) * 15}px`);
                img.style.setProperty('--tx-75', `${(Math.random() - 0.5) * 12}px`);
                img.style.setProperty('--ty-75', `${(Math.random() - 0.5) * 18}px`);
                img.style.setProperty('--rot-0', '0deg');
                img.style.setProperty('--rot-25', `${(Math.random() - 0.5) * 4}deg`);
                img.style.setProperty('--rot-50', `${(Math.random() - 0.5) * 3}deg`);
                img.style.setProperty('--rot-75', `${(Math.random() - 0.5) * 3.5}deg`);
            });
        }

        function handleDragStart(e) {
            const target = e.type === 'mousedown' ? e.target : e.touches[0].target;
            if (target.classList.contains('float')) {
                e.preventDefault();
                isDragging = true;
                draggedItem = target;
                maxZIndex += 1;
                draggedItem.style.zIndex = maxZIndex.toString();
                const rect = draggedItem.getBoundingClientRect();
                const startX = e.type === 'mousedown' ? e.clientX : e.touches[0].clientX;
                const startY = e.type === 'mousedown' ? e.clientY : e.touches[0].clientY;
                initialX = startX - rect.left;
                initialY = startY - rect.top;
                draggedItem.classList.add('dragging');
                draggedItem.style.animation = 'none';
            }
        }

        function handleDrag(e) {
            if (!isDragging || !draggedItem) return;
            e.preventDefault();
            const moveX = e.type === 'mousemove' ? e.clientX : e.touches[0].clientX;
            const moveY = e.type === 'mousemove' ? e.clientY : e.touches[0].clientY;
            const x = Math.min(Math.max(0, moveX - initialX), window.innerWidth - 100);
            const y = Math.min(Math.max(0, moveY - initialY), window.innerHeight - 100);
            draggedItem.style.left = `${x}px`;
            draggedItem.style.top = `${y}px`;
        }

        function handleDragEnd() {
            if (!isDragging || !draggedItem) return;
            isDragging = false;
            draggedItem.classList.remove('dragging');
            draggedItem.style.animation = 'gentleFloat 8s ease-in-out infinite';
            draggedItem = null;
        }

        function createHeart(element) {
            const heart = document.createElement('div');
            heart.className = 'heart';
            heart.innerHTML = '❤';

            // Randomize position and animation
            const offsetX = (Math.random() - 0.5) * 40; // Horizontal offset
            const startX = parseInt(element.style.left) + element.offsetWidth / 2 + offsetX;
            const startY = parseInt(element.style.top);

            heart.style.left = `${startX}px`;
            heart.style.top = `${startY}px`;
            heart.style.position = 'absolute';
            heart.style.fontSize = '20px';
            heart.style.color = 'red';
            heart.style.opacity = '0';
            heart.style.transition = 'transform 1.5s ease-out, opacity 1.5s ease-out';

            document.body.appendChild(heart);

            // Trigger animation
            setTimeout(() => {
                heart.style.transform = `translateY(-100px) scale(1.2)`;
                heart.style.opacity = '1';
            }, 50);

            // Remove heart after animation
            setTimeout(() => {
                heart.style.opacity = '0';
                setTimeout(() => heart.remove(), 500); // Ensure removal after fade-out
            }, 1500);
        }

        function triggerHeartAnimations() {
            setInterval(() => {
                const availableImages = Array.from(floatImages).filter(img => !img.classList.contains('dragging'));
                const numHearts = Math.floor(Math.random() * 3) + 1; // Randomly select 1-3 images
                const selectedImages = [];

                while (selectedImages.length < numHearts && availableImages.length > 0) {
                    const randomIndex = Math.floor(Math.random() * availableImages.length);
                    selectedImages.push(availableImages.splice(randomIndex, 1)[0]);
                }

                selectedImages.forEach(img => {
                    for (let i = 0; i < 5; i++) { // Drop 5 hearts per image
                        setTimeout(() => createHeart(img), i * 300); // Staggered drops
                    }
                });
            }, 8000); // Trigger every 8 seconds
        }

        positionImages();
        triggerHeartAnimations();
        window.addEventListener('resize', positionImages);
        floatImages.forEach(img => {
            img.addEventListener('mousedown', handleDragStart);
            img.addEventListener('touchstart', handleDragStart, { passive: false });
        });
        document.addEventListener('mousemove', handleDrag);
        document.addEventListener('mouseup', handleDragEnd);
        document.addEventListener('touchmove', handleDrag, { passive: false });
        document.addEventListener('touchend', handleDragEnd);
    });
</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const floatImages = document.querySelectorAll('.float');
        let maxZIndex = 2;

        function positionImages() {
            // ...existing code...
        }

        function createHeart(element) {
            const heart = document.createElement('div');
            heart.className = 'heart';
            heart.innerHTML = '❤';
            const offsetX = (Math.random() - 0.5) * 40; // Random horizontal offset
            const startX = parseInt(element.style.left) + element.offsetWidth / 2 + offsetX;
            const startY = parseInt(element.style.top);
            heart.style.left = `${startX}px`;
            heart.style.top = `${startY}px`;
            heart.style.position = 'absolute';
            heart.style.fontSize = '20px';
            heart.style.color = 'red';
            heart.style.opacity = '0';
            heart.style.transition = 'transform 1.5s ease-out, opacity 1.5s ease-out';

            document.body.appendChild(heart);

            // Trigger animation
            setTimeout(() => {
                heart.style.transform = `translateY(-100px) scale(1.2)`;
                heart.style.opacity = '1';
            }, 50);

            // Remove heart after animation
            setTimeout(() => {
                heart.style.opacity = '0';
                setTimeout(() => heart.remove(), 500); // Ensure removal after fade-out
            }, 1500);
        }

        function triggerHeartAnimations() {
            setInterval(() => {
                const availableImages = Array.from(floatImages).filter(img => !img.classList.contains('dragging'));
                const numHearts = Math.floor(Math.random() * 3) + 1; // Randomly select 1-3 images
                const selectedImages = [];

                while (selectedImages.length < numHearts && availableImages.length > 0) {
                    const randomIndex = Math.floor(Math.random() * availableImages.length);
                    selectedImages.push(availableImages.splice(randomIndex, 1)[0]);
                }

                selectedImages.forEach(img => {
                    for (let i = 0; i < 5; i++) { // Drop 5 hearts per image
                        setTimeout(() => createHeart(img), i * 300); // Staggered drops
                    }
                });
            }, 8000); // Trigger every 8 seconds
        }

        triggerHeartAnimations();

        // Drag and drop functionality
        floatImages.forEach(img => {
            img.addEventListener('mousedown', handleDragStart);
            img.addEventListener('touchstart', handleDragStart, { passive: false });
        });

        document.addEventListener('mousemove', handleDrag);
        document.addEventListener('mouseup', handleDragEnd);
        document.addEventListener('touchmove', handleDrag, { passive: false });
        document.addEventListener('touchend', handleDragEnd);

        function handleDragStart(e) {
            // ...existing code...
        }

        function handleDrag(e) {
            // ...existing code...
        }

        function handleDragEnd() {
            // ...existing code...
        }
    });
</script>
</body>

</html>
